<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>PKM Kaben - Satu Data</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        primary: {
                            50: '#eef2ff',
                            100: '#e0e7ff',
                            200: '#c7d2fe',
                            300: '#a5b4fc',
                            400: '#818cf8',
                            500: '#6366f1',
                            600: '#4f46e5',
                            700: '#4338ca',
                            800: '#3730a3',
                            900: '#312e81',
                        },
                        secondary: {
                            50: '#f0f9ff',
                            100: '#e0f2fe',
                            200: '#bae6fd',
                            300: '#7dd3fc',
                            400: '#38bdf8',
                            500: '#0ea5e9',
                            600: '#0284c7',
                            700: '#0369a1',
                            800: '#075985',
                            900: '#0c4a6e',
                        }
                    },
                    fontFamily: {
                        'sans': ['Inter', 'ui-sans-serif', 'system-ui', '-apple-system', 'Segoe UI', 'sans-serif'],
                    },
                    boxShadow: {
                        'card': '0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -1px rgba(0, 0, 0, 0.06)',
                        'card-hover': '0 10px 15px -3px rgba(0, 0, 0, 0.1), 0 4px 6px -2px rgba(0, 0, 0, 0.05)',
                    }
                }
            }
        }
    </script>
    <script src="https://cdn.jsdelivr.net/npm/apexcharts"></script>
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/xlsx@0.18.5/dist/xlsx.full.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/file-saver@2.0.5/dist/FileSaver.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/PapaParse/5.3.0/papaparse.min.js"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.1.1/css/all.min.css" />
    
    <!-- CSS untuk Print -->
    <style>
        @media print {
            body * {
                visibility: hidden;
            }
            #results, #results * {
                visibility: visible;
            }
            #printBtn, #analyzeBtn, #loadingIndicator, .print-hide {
                display: none !important;
            }
            #results {
                position: absolute;
                left: 0;
                top: 0;
                width: 100%;
                box-shadow: none;
                background: white;
                padding: 20px;
            }
            .print-full-width {
                width: 100% !important;
            }
            /* Atur mode landscape */
            @page {
                size: landscape;
            }
            /* Pastikan tabel tidak terpotong */
            table {
                width: 100% !important;
                table-layout: auto !important;
                page-break-inside: avoid;
            }
            /* Hindari pemotongan baris tabel */
            tr {
                page-break-inside: avoid;
            }
            /* Pastikan semua sel terlihat */
            td, th {
                white-space: normal !important;
                overflow: visible !important;
                font-size: 10pt !important;
            }
            /* Atur agar chart terlihat penuh */
            #chartArea {
                max-width: 100% !important;
                width: 100% !important;
                height: auto !important;
                max-height: 500px !important;
                page-break-inside: avoid;
            }
            /* Atur overflow untuk data yang lebar */
            #tableArea {
                overflow: visible !important;
                width: 100% !important;
            }
        }
        .print-only {
            display: none;
        }
        @media print {
            .print-only {
                display: block;
            }
        }

        /* Custom Scrollbar */
        ::-webkit-scrollbar {
            width: 8px;
            height: 8px;
        }
        ::-webkit-scrollbar-track {
            background: #f1f1f1;
            border-radius: 10px;
        }
        ::-webkit-scrollbar-thumb {
            background: #c7d2fe;
            border-radius: 10px;
        }
        ::-webkit-scrollbar-thumb:hover {
            background: #4f46e5;
        }
        
        /* Animations */
        .fade-in {
            animation: fadeIn 0.3s ease-in-out;
        }
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }
        
        /* Tooltip Styles */
        .tooltip {
            position: relative;
            display: inline-block;
        }
        .tooltip .tooltip-text {
            visibility: hidden;
            width: 200px;
            background-color: #1e293b;
            color: white;
            text-align: center;
            border-radius: 6px;
            padding: 8px;
            position: absolute;
            z-index: 1;
            bottom: 125%;
            left: 50%;
            margin-left: -100px;
            opacity: 0;
            transition: opacity 0.3s;
            font-size: 0.75rem;
            box-shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.1);
        }
        .tooltip .tooltip-text::after {
            content: "";
            position: absolute;
            top: 100%;
            left: 50%;
            margin-left: -5px;
            border-width: 5px;
            border-style: solid;
            border-color: #1e293b transparent transparent transparent;
        }
        .tooltip:hover .tooltip-text {
            visibility: visible;
            opacity: 1;
        }
        
        /* Loading Spinner */
        .spinner {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            border: 3px solid rgba(99, 102, 241, 0.1);
            border-top-color: #6366f1;
            animation: spin 1s linear infinite;
        }
        @keyframes spin {
            to { transform: rotate(360deg); }
        }
        
        /* Card Hover Effects */
        .card-hover {
            transition: all 0.3s ease;
        }
        .card-hover:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 25px -5px rgba(0, 0, 0, 0.1), 0 10px 10px -5px rgba(0, 0, 0, 0.04);
        }
        
        /* Button Effects */
        .btn-hover {
            transition: all 0.3s ease;
            position: relative;
            overflow: hidden;
        }
        .btn-hover:after {
            content: '';
            position: absolute;
            width: 100%;
            height: 100%;
            top: 0;
            left: -100%;
            background: linear-gradient(90deg, rgba(255,255,255,0) 0%, rgba(255,255,255,0.2) 50%, rgba(255,255,255,0) 100%);
            transition: all 0.3s ease;
        }
        .btn-hover:hover:after {
            left: 100%;
        }
        
        /* Modal Animations */
        .modal-enter {
            animation: modalEnter 0.3s forwards;
        }
        .modal-exit {
            animation: modalExit 0.3s forwards;
        }
        @keyframes modalEnter {
            from { opacity: 0; transform: scale(0.95); }
            to { opacity: 1; transform: scale(1); }
        }
        @keyframes modalExit {
            from { opacity: 1; transform: scale(1); }
            to { opacity: 0; transform: scale(0.95); }
        }
        
        /* Table Styling */
        .data-table {
            border-collapse: separate;
            border-spacing: 0;
        }
        .data-table th {
            position: sticky;
            top: 0;
            background-color: #f8fafc;
            z-index: 10;
        }
        .data-table tbody tr {
            transition: background-color 0.2s;
        }
        .data-table tbody tr:hover {
            background-color: #f1f5f9;
        }
        
        /* Form Controls */
        .form-input:focus, .form-select:focus {
            box-shadow: 0 0 0 2px rgba(99, 102, 241, 0.2);
        }
    </style>
</head>
<body class="bg-gray-50 font-sans text-gray-800">
    <!-- Navbar -->
    <nav class="bg-white shadow">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
            <div class="flex justify-between h-16">
                <div class="flex items-center">
                    <button class="bg-gradient-to-r from-primary-600 to-secondary-600 rounded-md p-1">
                        <a href="/dashboard" class="flex items-center">
                            <span class="text-xl font-bold text-white px-4 hover:scale-105 transition-all duration-300 flex items-center">
                                <i class="fas fa-chart-line mr-2"></i>
                                Dashboard
                            </span>
                        </a>
                    </button>
                    <h1 class="ml-4 text-xl font-semibold text-gray-700 hidden md:block">PKM Kaben - Satu Data</h1>
                </div>
                <div class="flex items-center space-x-3">
                    <span id="importInfoBadge" class="hidden inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-primary-100 text-primary-800">
                        <svg class="-ml-0.5 mr-1.5 h-2 w-2 text-primary-400" fill="currentColor" viewBox="0 0 8 8">
                            <circle cx="4" cy="4" r="3" />
                        </svg>
                        <span id="importInfoText">Data: -</span>
                    </span>
                    <button id="importFileBtn" class="bg-gradient-to-r from-primary-600 to-purple-600 text-white px-4 py-2 rounded-md hover:from-primary-700 hover:to-purple-700 focus:outline-none focus:ring-2 focus:ring-primary-500 focus:ring-offset-2 btn-hover flex items-center shadow-md">
                        <i class="fas fa-file-import mr-2"></i>
                        Import Data
                    </button>
                </div>
            </div>
        </div>
    </nav>

    <!-- Main Content -->
    <main class="max-w-7xl mx-auto py-6 px-4 sm:px-6 lg:px-8">
        <!-- Filter Section -->
        <div class="bg-white rounded-xl shadow-card p-6 mb-6 fade-in transition-all hover:shadow-card-hover">
            <div class="flex items-center mb-4">
                <i class="fas fa-filter text-primary-500 mr-2 text-xl"></i>
                <h2 class="text-lg font-semibold text-gray-800">Filter & Analisis</h2>
            </div>
            
            <!-- Variable Groups -->
            <div class="grid grid-cols-1 md:grid-cols-2 gap-6 mb-6">
                @foreach($variableGroups as $groupKey => $group)
                    <div class="bg-gray-50 p-4 rounded-lg border border-gray-100 shadow-sm">
                        <h3 class="text-md font-medium text-gray-700 mb-3 flex items-center">
                            <i class="fas fa-layer-group text-primary-400 mr-2"></i>
                            {{ $group['title'] }}
                        </h3>
                        <div class="space-y-3">
                            @foreach($group['variables'] as $key => $variable)
                                <div>
                                    <label class="block text-sm font-medium text-gray-700 mb-1 flex items-center">
                                        <i class="fas fa-tag text-gray-400 mr-1 text-xs"></i>
                                        {{ $variable['label'] }}
                                    </label>

                                    @if($variable['type'] === 'select')
                                        <select name="filters[{{ $key }}]" 
                                                class="form-select w-full rounded-md border-gray-300 shadow-sm focus:border-primary-300 focus:ring focus:ring-primary-200 focus:ring-opacity-50 text-sm">
                                            <option value="">Semua</option>
                                            @foreach($variable['options'] as $optionKey => $optionLabel)
                                                <option value="{{ $optionKey }}">{{ $optionLabel }}</option>
                                            @endforeach
                                        </select>

                                    @elseif($variable['type'] === 'boolean')
                                        <div class="space-y-2">
                                            <label class="inline-flex items-center">
                                                <input type="radio" name="filters[{{ $key }}]" 
                                                       value="" class="text-primary-600 focus:ring-primary-500" checked>
                                                <span class="ml-2 text-sm text-gray-700">Semua</span>
                                            </label>
                                            @foreach($variable['options'] as $optionKey => $optionLabel)
                                                <label class="inline-flex items-center">
                                                    <input type="radio" name="filters[{{ $key }}]" 
                                                           value="{{ $optionKey }}" class="text-primary-600 focus:ring-primary-500">
                                                    <span class="ml-2 text-sm text-gray-700">{{ $optionLabel }}</span>
                                                </label>
                                            @endforeach
                                        </div>

                                    @elseif($variable['type'] === 'range')
                                        <select name="filters[{{ $key }}]" 
                                                class="form-select w-full rounded-md border-gray-300 shadow-sm focus:border-primary-300 focus:ring focus:ring-primary-200 focus:ring-opacity-50 text-sm">
                                            <option value="">Semua</option>
                                            @foreach($variable['options'] as $optionKey => $optionLabel)
                                                <option value="{{ $optionKey }}">{{ $optionLabel }}</option>
                                            @endforeach
                                        </select>

                                    @elseif($variable['type'] === 'age_filter')
                                        <div class="space-y-3">
                                            <select id="age_filter_select_{{ $key }}" 
                                                    class="form-select w-full rounded-md border-gray-300 shadow-sm focus:border-primary-300 focus:ring focus:ring-primary-200 focus:ring-opacity-50 text-sm">
                                                <option value="">Semua</option>
                                                @foreach($variable['options'] as $optionKey => $optionLabel)
                                                    <option value="{{ $optionKey }}">{{ $optionLabel }}</option>
                                                @endforeach
                                            </select>
                                            
                                            <div id="custom_age_range_{{ $key }}" class="hidden mt-2">
                                                <div class="grid grid-cols-2 gap-2">
                                                    <div>
                                                        <label class="block text-xs font-medium text-gray-700 mb-1">Usia minimum</label>
                                                        <input type="number" id="age_min_{{ $key }}" min="0" max="120" 
                                                               class="form-input w-full rounded-md border-gray-300 shadow-sm focus:border-primary-300 focus:ring focus:ring-primary-200 focus:ring-opacity-50 text-sm"
                                                               placeholder="Min">
                                                    </div>
                                                    <div>
                                                        <label class="block text-xs font-medium text-gray-700 mb-1">Usia maksimum</label>
                                                        <input type="number" id="age_max_{{ $key }}" min="0" max="120"
                                                               class="form-input w-full rounded-md border-gray-300 shadow-sm focus:border-primary-300 focus:ring focus:ring-primary-200 focus:ring-opacity-50 text-sm"
                                                               placeholder="Max">
                                                    </div>
                                                </div>
                                                <div class="mt-2">
                                                    <button type="button" id="apply_custom_age_{{ $key }}" 
                                                            class="w-full px-2 py-1 text-xs bg-primary-600 text-white rounded-md hover:bg-primary-700 focus:outline-none focus:ring-2 focus:ring-primary-500 focus:ring-offset-1">
                                                        Terapkan Rentang Usia
                                                    </button>
                                                </div>
                                            </div>
                                            
                                            <input type="hidden" name="filters[{{ $key }}]" id="age_filter_value_{{ $key }}">
                                        </div>

                                    @elseif($variable['type'] === 'number')
                                        <div class="space-y-2">
                                            <label class="inline-flex items-center">
                                                <input type="radio" name="filters[{{ $key }}]" 
                                                       value="" class="text-primary-600 focus:ring-primary-500" checked>
                                                <span class="ml-2 text-sm text-gray-700">Semua</span>
                                            </label>
                                            @foreach($variable['options'] as $optionKey => $optionLabel)
                                                <label class="inline-flex items-center">
                                                    <input type="radio" name="filters[{{ $key }}]" 
                                                           value="{{ $optionKey }}" class="text-primary-600 focus:ring-primary-500">
                                                    <span class="ml-2 text-sm text-gray-700">{{ $optionLabel }}</span>
                                                </label>
                                            @endforeach
                                        </div>

                                    @elseif($variable['type'] === 'string')
                                        <div class="space-y-2">
                                            <label class="inline-flex items-center">
                                                <input type="radio" name="filters[{{ $key }}]" 
                                                       value="" class="text-primary-600 focus:ring-primary-500" checked>
                                                <span class="ml-2 text-sm text-gray-700">Semua</span>
                                            </label>
                                            @foreach($variable['options'] as $optionKey => $optionLabel)
                                                <label class="inline-flex items-center">
                                                    <input type="radio" name="filters[{{ $key }}]" 
                                                           value="{{ $optionKey }}" class="text-primary-600 focus:ring-primary-500">
                                                    <span class="ml-2 text-sm text-gray-700">{{ $optionLabel }}</span>
                                                </label>
                                            @endforeach
                                        </div>

                                    @elseif($variable['type'] === 'date')
                                        <div class="space-y-2">
                                            <label class="inline-flex items-center">
                                                <input type="radio" name="filters[{{ $key }}]" 
                                                       value="" class="text-primary-600 focus:ring-primary-500" checked>
                                                <span class="ml-2 text-sm text-gray-700">Semua</span>
                                            </label>
                                            @foreach($variable['options'] as $optionKey => $optionLabel)
                                                <label class="inline-flex items-center">
                                                    <input type="radio" name="filters[{{ $key }}]" 
                                                           value="{{ $optionKey }}" class="text-primary-600 focus:ring-primary-500">
                                                    <span class="ml-2 text-sm text-gray-700">{{ $optionLabel }}</span>
                                                </label>
                                            @endforeach
                                        </div>

                                    @elseif($variable['type'] === 'datetime')
                                        <div class="space-y-2">
                                            <label class="inline-flex items-center">
                                                <input type="radio" name="filters[{{ $key }}]" 
                                                       value="" class="text-primary-600 focus:ring-primary-500" checked>
                                                <span class="ml-2 text-sm text-gray-700">Semua</span>
                                            </label>
                                            @foreach($variable['options'] as $optionKey => $optionLabel)
                                                <label class="inline-flex items-center">
                                                    <input type="radio" name="filters[{{ $key }}]" 
                                                           value="{{ $optionKey }}" class="text-primary-600 focus:ring-primary-500">
                                                    <span class="ml-2 text-sm text-gray-700">{{ $optionLabel }}</span>
                                                </label>
                                            @endforeach
                                        </div>

                                    @elseif($variable['type'] === 'time')
                                        <div class="space-y-2">
                                            <label class="inline-flex items-center">
                                                <input type="radio" name="filters[{{ $key }}]" 
                                                       value="" class="text-primary-600 focus:ring-primary-500" checked>
                                                <span class="ml-2 text-sm text-gray-700">Semua</span>
                                            </label>
                                            @foreach($variable['options'] as $optionKey => $optionLabel)
                                                <label class="inline-flex items-center">
                                                    <input type="radio" name="filters[{{ $key }}]" 
                                                           value="{{ $optionKey }}" class="text-primary-600 focus:ring-primary-500">
                                                    <span class="ml-2 text-sm text-gray-700">{{ $optionLabel }}</span>
                                                </label>
                                            @endforeach
                                        </div>

                                    @elseif($variable['type'] === 'textarea')
                                        <div class="space-y-2">
                                            <label class="inline-flex items-center">
                                                <input type="radio" name="filters[{{ $key }}]" 
                                                       value="" class="text-primary-600 focus:ring-primary-500" checked>
                                                <span class="ml-2 text-sm text-gray-700">Semua</span>
                                            </label>
                                            @foreach($variable['options'] as $optionKey => $optionLabel)
                                                <label class="inline-flex items-center">
                                                    <input type="radio" name="filters[{{ $key }}]" 
                                                           value="{{ $optionKey }}" class="text-primary-600 focus:ring-primary-500">
                                                    <span class="ml-2 text-sm text-gray-700">{{ $optionLabel }}</span>
                                                </label>
                                            @endforeach
                                        </div>

                                    @elseif($variable['type'] === 'file')
                                        <div class="space-y-2">
                                            <label class="inline-flex items-center">
                                                <input type="radio" name="filters[{{ $key }}]" 
                                                       value="" class="text-primary-600 focus:ring-primary-500" checked>
                                                <span class="ml-2 text-sm text-gray-700">Semua</span>
                                            </label>
                                            @foreach($variable['options'] as $optionKey => $optionLabel)
                                                <label class="inline-flex items-center">
                                                    <input type="radio" name="filters[{{ $key }}]" 
                                                           value="{{ $optionKey }}" class="text-primary-600 focus:ring-primary-500">
                                                    <span class="ml-2 text-sm text-gray-700">{{ $optionLabel }}</span>
                                                </label>
                                            @endforeach
                                        </div>

                                    @elseif($variable['type'] === 'image')
                                        <div class="space-y-2">
                                            <label class="inline-flex items-center">
                                                <input type="radio" name="filters[{{ $key }}]" 
                                                       value="" class="text-primary-600 focus:ring-primary-500" checked>
                                                <span class="ml-2 text-sm text-gray-700">Semua</span>
                                            </label>
                                            @foreach($variable['options'] as $optionKey => $optionLabel)
                                                <label class="inline-flex items-center">
                                                    <input type="radio" name="filters[{{ $key }}]" 
                                                           value="{{ $optionKey }}" class="text-primary-600 focus:ring-primary-500">
                                                    <span class="ml-2 text-sm text-gray-700">{{ $optionLabel }}</span>
                                                </label>
                                            @endforeach
                                        </div>

                                    @elseif($variable['type'] === 'video')
                                        <div class="space-y-2">
                                            <label class="inline-flex items-center">
                                                <input type="radio" name="filters[{{ $key }}]" 
                                                       value="" class="text-primary-600 focus:ring-primary-500" checked>
                                                <span class="ml-2 text-sm text-gray-700">Semua</span>
                                            </label>
                                            @foreach($variable['options'] as $optionKey => $optionLabel)
                                                <label class="inline-flex items-center">
                                                    <input type="radio" name="filters[{{ $key }}]" 
                                                           value="{{ $optionKey }}" class="text-primary-600 focus:ring-primary-500">
                                                    <span class="ml-2 text-sm text-gray-700">{{ $optionLabel }}</span>
                                                </label>
                                            @endforeach
                                        </div>

                                    @elseif($variable['type'] === 'audio')
                                        <div class="space-y-2">
                                            <label class="inline-flex items-center">
                                                <input type="radio" name="filters[{{ $key }}]" 
                                                       value="" class="text-primary-600 focus:ring-primary-500" checked>
                                                <span class="ml-2 text-sm text-gray-700">Semua</span>
                                            </label>
                                            @foreach($variable['options'] as $optionKey => $optionLabel)
                                                <label class="inline-flex items-center">
                                                    <input type="radio" name="filters[{{ $key }}]" 
                                                           value="{{ $optionKey }}" class="text-primary-600 focus:ring-primary-500">
                                                    <span class="ml-2 text-sm text-gray-700">{{ $optionLabel }}</span>
                                                </label>
                                            @endforeach
                                        </div>

                                    @elseif($variable['type'] === 'link')
                                        <div class="space-y-2">
                                            <label class="inline-flex items-center">
                                                <input type="radio" name="filters[{{ $key }}]" 
                                                       value="" class="text-primary-600 focus:ring-primary-500" checked>
                                                <span class="ml-2 text-sm text-gray-700">Semua</span>
                                            </label>
                                            @foreach($variable['options'] as $optionKey => $optionLabel)
                                                <label class="inline-flex items-center">
                                                    <input type="radio" name="filters[{{ $key }}]" 
                                                           value="{{ $optionKey }}" class="text-primary-600 focus:ring-primary-500">
                                                    <span class="ml-2 text-sm text-gray-700">{{ $optionLabel }}</span>
                                                </label>
                                            @endforeach
                                        </div>

                                    @elseif($variable['type'] === 'email')
                                        <div class="space-y-2">
                                            <label class="inline-flex items-center">
                                                <input type="radio" name="filters[{{ $key }}]" 
                                                       value="" class="text-primary-600 focus:ring-primary-500" checked>
                                                <span class="ml-2 text-sm text-gray-700">Semua</span>
                                            </label>
                                            @foreach($variable['options'] as $optionKey => $optionLabel)
                                                <label class="inline-flex items-center">
                                                    <input type="radio" name="filters[{{ $key }}]" 
                                                           value="{{ $optionKey }}" class="text-primary-600 focus:ring-primary-500">
                                                    <span class="ml-2 text-sm text-gray-700">{{ $optionLabel }}</span>
                                                </label>
                                            @endforeach
                                        </div>

                                    @elseif($variable['type'] === 'url')
                                        <div class="space-y-2">
                                            <label class="inline-flex items-center">
                                                <input type="radio" name="filters[{{ $key }}]" 
                                                       value="" class="text-primary-600 focus:ring-primary-500" checked>
                                                <span class="ml-2 text-sm text-gray-700">Semua</span>
                                            </label>
                                            @foreach($variable['options'] as $optionKey => $optionLabel)
                                                <label class="inline-flex items-center">
                                                    <input type="radio" name="filters[{{ $key }}]" 
                                                           value="{{ $optionKey }}" class="text-primary-600 focus:ring-primary-500">
                                                    <span class="ml-2 text-sm text-gray-700">{{ $optionLabel }}</span>
                                                </label>
                                            @endforeach
                                        </div>

                                    @elseif($variable['type'] === 'tel')
                                        <div class="space-y-2">
                                            <label class="inline-flex items-center">
                                                <input type="radio" name="filters[{{ $key }}]" 
                                                       value="" class="text-primary-600 focus:ring-primary-500" checked>
                                                <span class="ml-2 text-sm text-gray-700">Semua</span>
                                            </label>
                                            @foreach($variable['options'] as $optionKey => $optionLabel)
                                                <label class="inline-flex items-center">
                                                    <input type="radio" name="filters[{{ $key }}]" 
                                                           value="{{ $optionKey }}" class="text-primary-600 focus:ring-primary-500">
                                                    <span class="ml-2 text-sm text-gray-700">{{ $optionLabel }}</span>
                                                </label>
                                            @endforeach
                                        </div>

                                    @elseif($variable['type'] === 'password')
                                        <div class="space-y-2">
                                            <label class="inline-flex items-center">
                                                <input type="radio" name="filters[{{ $key }}]" 
                                                       value="" class="text-primary-600 focus:ring-primary-500" checked>
                                                <span class="ml-2 text-sm text-gray-700">Semua</span>
                                            </label>
                                            @foreach($variable['options'] as $optionKey => $optionLabel)
                                                <label class="inline-flex items-center">
                                                    <input type="radio" name="filters[{{ $key }}]" 
                                                           value="{{ $optionKey }}" class="text-primary-600 focus:ring-primary-500">
                                                    <span class="ml-2 text-sm text-gray-700">{{ $optionLabel }}</span>
                                                </label>
                                            @endforeach
                                        </div>

                                    @elseif($variable['type'] === 'checkbox')
                                        <div class="space-y-2">
                                            <label class="inline-flex items-center">
                                                <input type="checkbox" name="filters[{{ $key }}]" 
                                                       value="" class="text-primary-600 focus:ring-primary-500">
                                                <span class="ml-2 text-sm text-gray-700">Semua</span>
                                            </label>
                                            @foreach($variable['options'] as $optionKey => $optionLabel)
                                                <label class="inline-flex items-center">
                                                    <input type="checkbox" name="filters[{{ $key }}]" 
                                                           value="{{ $optionKey }}" class="text-primary-600 focus:ring-primary-500">
                                                    <span class="ml-2 text-sm text-gray-700">{{ $optionLabel }}</span>
                                                </label>
                                            @endforeach
                                        </div>

                                    @elseif($variable['type'] === 'radio')
                                        <div class="space-y-2">
                                            <label class="inline-flex items-center">
                                                <input type="radio" name="filters[{{ $key }}]" 
                                                       value="" class="text-primary-600 focus:ring-primary-500" checked>
                                                <span class="ml-2 text-sm text-gray-700">Semua</span>
                                            </label>
                                            @foreach($variable['options'] as $optionKey => $optionLabel)
                                                <label class="inline-flex items-center">
                                                    <input type="radio" name="filters[{{ $key }}]" 
                                                           value="{{ $optionKey }}" class="text-primary-600 focus:ring-primary-500">
                                                    <span class="ml-2 text-sm text-gray-700">{{ $optionLabel }}</span>
                                                </label>
                                            @endforeach
                                        </div>

                                    @elseif($variable['type'] === 'select')
                                        <select name="filters[{{ $key }}]" 
                                                class="form-select w-full rounded-md border-gray-300 shadow-sm focus:border-primary-300 focus:ring focus:ring-primary-200 focus:ring-opacity-50 text-sm">
                                            <option value="">Semua</option>
                                            @foreach($variable['options'] as $optionKey => $optionLabel)
                                                <option value="{{ $optionKey }}">{{ $optionLabel }}</option>
                                            @endforeach
                                        </select>

                                    @elseif($variable['type'] === 'boolean')
                                        <div class="space-y-2">
                                            <label class="inline-flex items-center">
                                                <input type="radio" name="filters[{{ $key }}]" 
                                                       value="" class="text-primary-600 focus:ring-primary-500" checked>
                                                <span class="ml-2 text-sm text-gray-700">Semua</span>
                                            </label>
                                            @foreach($variable['options'] as $optionKey => $optionLabel)
                                                <label class="inline-flex items-center">
                                                    <input type="radio" name="filters[{{ $key }}]" 
                                                           value="{{ $optionKey }}" class="text-primary-600 focus:ring-primary-500">
                                                    <span class="ml-2 text-sm text-gray-700">{{ $optionLabel }}</span>
                                                </label>
                                            @endforeach
                                        </div>

                                    @elseif($variable['type'] === 'age_filter')
                                        <div class="space-y-3">
                                            <select id="age_filter_select_{{ $key }}" 
                                                    class="form-select w-full rounded-md border-gray-300 shadow-sm focus:border-primary-300 focus:ring focus:ring-primary-200 focus:ring-opacity-50 text-sm">
                                                <option value="">Semua</option>
                                                @foreach($variable['options'] as $optionKey => $optionLabel)
                                                    <option value="{{ $optionKey }}">{{ $optionLabel }}</option>
                                                @endforeach
                                            </select>
                                            
                                            <div id="custom_age_range_{{ $key }}" class="hidden mt-2">
                                                <div class="grid grid-cols-2 gap-2">
                                                    <div>
                                                        <label class="block text-xs font-medium text-gray-700 mb-1">Usia minimum</label>
                                                        <input type="number" id="age_min_{{ $key }}" min="0" max="120" 
                                                               class="form-input w-full rounded-md border-gray-300 shadow-sm focus:border-primary-300 focus:ring focus:ring-primary-200 focus:ring-opacity-50 text-sm"
                                                               placeholder="Min">
                                                    </div>
                                                    <div>
                                                        <label class="block text-xs font-medium text-gray-700 mb-1">Usia maksimum</label>
                                                        <input type="number" id="age_max_{{ $key }}" min="0" max="120"
                                                               class="form-input w-full rounded-md border-gray-300 shadow-sm focus:border-primary-300 focus:ring focus:ring-primary-200 focus:ring-opacity-50 text-sm"
                                                               placeholder="Max">
                                                    </div>
                                                </div>
                                                <div class="mt-2">
                                                    <button type="button" id="apply_custom_age_{{ $key }}" 
                                                            class="w-full px-2 py-1 text-xs bg-primary-600 text-white rounded-md hover:bg-primary-700 focus:outline-none focus:ring-2 focus:ring-primary-500 focus:ring-offset-1">
                                                        Terapkan Rentang Usia
                                                    </button>
                                                </div>
                                            </div>
                                            
                                            <input type="hidden" name="filters[{{ $key }}]" id="age_filter_value_{{ $key }}">
                                        </div>

                                    @elseif($variable['type'] === 'number')
                                        <div class="space-y-2">
                                            <label class="inline-flex items-center">
                                                <input type="radio" name="filters[{{ $key }}]" 
                                                       value="" class="text-primary-600 focus:ring-primary-500" checked>
                                                <span class="ml-2 text-sm text-gray-700">Semua</span>
                                            </label>
                                            @foreach($variable['options'] as $optionKey => $optionLabel)
                                                <label class="inline-flex items-center">
                                                    <input type="radio" name="filters[{{ $key }}]" 
                                                           value="{{ $optionKey }}" class="text-primary-600 focus:ring-primary-500">
                                                    <span class="ml-2 text-sm text-gray-700">{{ $optionLabel }}</span>
                                                </label>
                                            @endforeach
                                        </div>

                                    @elseif($variable['type'] === 'string')
                                        <div class="space-y-2">
                                            <label class="inline-flex items-center">
                                                <input type="radio" name="filters[{{ $key }}]" 
                                                       value="" class="text-primary-600 focus:ring-primary-500" checked>
                                                <span class="ml-2 text-sm text-gray-700">Semua</span>
                                            </label>
                                            @foreach($variable['options'] as $optionKey => $optionLabel)
                                                <label class="inline-flex items-center">
                                                    <input type="radio" name="filters[{{ $key }}]" 
                                                           value="{{ $optionKey }}" class="text-primary-600 focus:ring-primary-500">
                                                    <span class="ml-2 text-sm text-gray-700">{{ $optionLabel }}</span>
                                                </label>
                                            @endforeach
                                        </div>

                                    @elseif($variable['type'] === 'date')
                                        <div class="space-y-2">
                                            <label class="inline-flex items-center">
                                                <input type="radio" name="filters[{{ $key }}]" 
                                                       value="" class="text-primary-600 focus:ring-primary-500" checked>
                                                <span class="ml-2 text-sm text-gray-700">Semua</span>
                                            </label>
                                            @foreach($variable['options'] as $optionKey => $optionLabel)
                                                <label class="inline-flex items-center">
                                                    <input type="radio" name="filters[{{ $key }}]" 
                                                           value="{{ $optionKey }}" class="text-primary-600 focus:ring-primary-500">
                                                    <span class="ml-2 text-sm text-gray-700">{{ $optionLabel }}</span>
                                                </label>
                                            @endforeach
                                        </div>

                                    @elseif($variable['type'] === 'datetime')
                                        <div class="space-y-2">
                                            <label class="inline-flex items-center">
                                                <input type="radio" name="filters[{{ $key }}]" 
                                                       value="" class="text-primary-600 focus:ring-primary-500" checked>
                                                <span class="ml-2 text-sm text-gray-700">Semua</span>
                                            </label>
                                            @foreach($variable['options'] as $optionKey => $optionLabel)
                                                <label class="inline-flex items-center">
                                                    <input type="radio" name="filters[{{ $key }}]" 
                                                           value="{{ $optionKey }}" class="text-primary-600 focus:ring-primary-500">
                                                    <span class="ml-2 text-sm text-gray-700">{{ $optionLabel }}</span>
                                                </label>
                                            @endforeach
                                        </div>

                                    @elseif($variable['type'] === 'time')
                                        <div class="space-y-2">
                                            <label class="inline-flex items-center">
                                                <input type="radio" name="filters[{{ $key }}]" 
                                                       value="" class="text-primary-600 focus:ring-primary-500" checked>
                                                <span class="ml-2 text-sm text-gray-700">Semua</span>
                                            </label>
                                            @foreach($variable['options'] as $optionKey => $optionLabel)
                                                <label class="inline-flex items-center">
                                                    <input type="radio" name="filters[{{ $key }}]" 
                                                           value="{{ $optionKey }}" class="text-primary-600 focus:ring-primary-500">
                                                    <span class="ml-2 text-sm text-gray-700">{{ $optionLabel }}</span>
                                                </label>
                                            @endforeach
                                        </div>

                                    @elseif($variable['type'] === 'textarea')
                                        <div class="space-y-2">
                                            <label class="inline-flex items-center">
                                                <input type="radio" name="filters[{{ $key }}]" 
                                                       value="" class="text-primary-600 focus:ring-primary-500" checked>
                                                <span class="ml-2 text-sm text-gray-700">Semua</span>
                                            </label>
                                            @foreach($variable['options'] as $optionKey => $optionLabel)
                                                <label class="inline-flex items-center">
                                                    <input type="radio" name="filters[{{ $key }}]" 
                                                           value="{{ $optionKey }}" class="text-primary-600 focus:ring-primary-500">
                                                    <span class="ml-2 text-sm text-gray-700">{{ $optionLabel }}</span>
                                                </label>
                                            @endforeach
                                        </div>

                                    @elseif($variable['type'] === 'file')
                                        <div class="space-y-2">
                                            <label class="inline-flex items-center">
                                                <input type="radio" name="filters[{{ $key }}]" 
                                                       value="" class="text-primary-600 focus:ring-primary-500" checked>
                                                <span class="ml-2 text-sm text-gray-700">Semua</span>
                                            </label>
                                            @foreach($variable['options'] as $optionKey => $optionLabel)
                                                <label class="inline-flex items-center">
                                                    <input type="radio" name="filters[{{ $key }}]" 
                                                           value="{{ $optionKey }}" class="text-primary-600 focus:ring-primary-500">
                                                    <span class="ml-2 text-sm text-gray-700">{{ $optionLabel }}</span>
                                                </label>
                                            @endforeach
                                        </div>

                                    @elseif($variable['type'] === 'image')
                                        <div class="space-y-2">
                                            <label class="inline-flex items-center">
                                                <input type="radio" name="filters[{{ $key }}]" 
                                                       value="" class="text-primary-600 focus:ring-primary-500" checked>
                                                <span class="ml-2 text-sm text-gray-700">Semua</span>
                                            </label>
                                            @foreach($variable['options'] as $optionKey => $optionLabel)
                                                <label class="inline-flex items-center">
                                                    <input type="radio" name="filters[{{ $key }}]" 
                                                           value="{{ $optionKey }}" class="text-primary-600 focus:ring-primary-500">
                                                    <span class="ml-2 text-sm text-gray-700">{{ $optionLabel }}</span>
                                                </label>
                                            @endforeach
                                        </div>

                                    @elseif($variable['type'] === 'video')
                                        <div class="space-y-2">
                                            <label class="inline-flex items-center">
                                                <input type="radio" name="filters[{{ $key }}]" 
                                                       value="" class="text-primary-600 focus:ring-primary-500" checked>
                                                <span class="ml-2 text-sm text-gray-700">Semua</span>
                                            </label>
                                            @foreach($variable['options'] as $optionKey => $optionLabel)
                                                <label class="inline-flex items-center">
                                                    <input type="radio" name="filters[{{ $key }}]" 
                                                           value="{{ $optionKey }}" class="text-primary-600 focus:ring-primary-500">
                                                    <span class="ml-2 text-sm text-gray-700">{{ $optionLabel }}</span>
                                                </label>
                                            @endforeach
                                        </div>

                                    @elseif($variable['type'] === 'audio')
                                        <div class="space-y-2">
                                            <label class="inline-flex items-center">
                                                <input type="radio" name="filters[{{ $key }}]" 
                                                       value="" class="text-primary-600 focus:ring-primary-500" checked>
                                                <span class="ml-2 text-sm text-gray-700">Semua</span>
                                            </label>
                                            @foreach($variable['options'] as $optionKey => $optionLabel)
                                                <label class="inline-flex items-center">
                                                    <input type="radio" name="filters[{{ $key }}]" 
                                                           value="{{ $optionKey }}" class="text-primary-600 focus:ring-primary-500">
                                                    <span class="ml-2 text-sm text-gray-700">{{ $optionLabel }}</span>
                                                </label>
                                            @endforeach
                                        </div>

                                    @elseif($variable['type'] === 'link')
                                        <div class="space-y-2">
                                            <label class="inline-flex items-center">
                                                <input type="radio" name="filters[{{ $key }}]" 
                                                       value="" class="text-primary-600 focus:ring-primary-500" checked>
                                                <span class="ml-2 text-sm text-gray-700">Semua</span>
                                            </label>
                                            @foreach($variable['options'] as $optionKey => $optionLabel)
                                                <label class="inline-flex items-center">
                                                    <input type="radio" name="filters[{{ $key }}]" 
                                                           value="{{ $optionKey }}" class="text-primary-600 focus:ring-primary-500">
                                                    <span class="ml-2 text-sm text-gray-700">{{ $optionLabel }}</span>
                                                </label>
                                            @endforeach
                                        </div>

                                    @elseif($variable['type'] === 'email')
                                        <div class="space-y-2">
                                            <label class="inline-flex items-center">
                                                <input type="radio" name="filters[{{ $key }}]" 
                                                       value="" class="text-primary-600 focus:ring-primary-500" checked>
                                                <span class="ml-2 text-sm text-gray-700">Semua</span>
                                            </label>
                                            @foreach($variable['options'] as $optionKey => $optionLabel)
                                                <label class="inline-flex items-center">
                                                    <input type="radio" name="filters[{{ $key }}]" 
                                                           value="{{ $optionKey }}" class="text-primary-600 focus:ring-primary-500">
                                                    <span class="ml-2 text-sm text-gray-700">{{ $optionLabel }}</span>
                                                </label>
                                            @endforeach
                                        </div>

                                    @elseif($variable['type'] === 'url')
                                        <div class="space-y-2">
                                            <label class="inline-flex items-center">
                                                <input type="radio" name="filters[{{ $key }}]" 
                                                       value="" class="text-primary-600 focus:ring-primary-500" checked>
                                                <span class="ml-2 text-sm text-gray-700">Semua</span>
                                            </label>
                                            @foreach($variable['options'] as $optionKey => $optionLabel)
                                                <label class="inline-flex items-center">
                                                    <input type="radio" name="filters[{{ $key }}]" 
                                                           value="{{ $optionKey }}" class="text-primary-600 focus:ring-primary-500">
                                                    <span class="ml-2 text-sm text-gray-700">{{ $optionLabel }}</span>
                                                </label>
                                            @endforeach
                                        </div>

                                    @elseif($variable['type'] === 'tel')
                                        <div class="space-y-2">
                                            <label class="inline-flex items-center">
                                                <input type="radio" name="filters[{{ $key }}]" 
                                                       value="" class="text-primary-600 focus:ring-primary-500" checked>
                                                <span class="ml-2 text-sm text-gray-700">Semua</span>
                                            </label>
                                            @foreach($variable['options'] as $optionKey => $optionLabel)
                                                <label class="inline-flex items-center">
                                                    <input type="radio" name="filters[{{ $key }}]" 
                                                           value="{{ $optionKey }}" class="text-primary-600 focus:ring-primary-500">
                                                    <span class="ml-2 text-sm text-gray-700">{{ $optionLabel }}</span>
                                                </label>
                                            @endforeach
                                        </div>

                                    @elseif($variable['type'] === 'password')
                                        <div class="space-y-2">
                                            <label class="inline-flex items-center">
                                                <input type="radio" name="filters[{{ $key }}]" 
                                                       value="" class="text-primary-600 focus:ring-primary-500" checked>
                                                <span class="ml-2 text-sm text-gray-700">Semua</span>
                                            </label>
                                            @foreach($variable['options'] as $optionKey => $optionLabel)
                                                <label class="inline-flex items-center">
                                                    <input type="radio" name="filters[{{ $key }}]" 
                                                           value="{{ $optionKey }}" class="text-primary-600 focus:ring-primary-500">
                                                    <span class="ml-2 text-sm text-gray-700">{{ $optionLabel }}</span>
                                                </label>
                                            @endforeach
                                        </div>

                                    @elseif($variable['type'] === 'checkbox')
                                        <div class="space-y-2">
                                            <label class="inline-flex items-center">
                                                <input type="checkbox" name="filters[{{ $key }}]" 
                                                       value="" class="text-primary-600 focus:ring-primary-500">
                                                <span class="ml-2 text-sm text-gray-700">Semua</span>
                                            </label>
                                            @foreach($variable['options'] as $optionKey => $optionLabel)
                                                <label class="inline-flex items-center">
                                                    <input type="checkbox" name="filters[{{ $key }}]" 
                                                           value="{{ $optionKey }}" class="text-primary-600 focus:ring-primary-500">
                                                    <span class="ml-2 text-sm text-gray-700">{{ $optionLabel }}</span>
                                                </label>
                                            @endforeach
                                        </div>

                                    @elseif($variable['type'] === 'radio')
                                        <div class="space-y-2">
                                            <label class="inline-flex items-center">
                                                <input type="radio" name="filters[{{ $key }}]" 
                                                       value="" class="text-primary-600 focus:ring-primary-500" checked>
                                                <span class="ml-2 text-sm text-gray-700">Semua</span>
                                            </label>
                                            @foreach($variable['options'] as $optionKey => $optionLabel)
                                                <label class="inline-flex items-center">
                                                    <input type="radio" name="filters[{{ $key }}]" 
                                                           value="{{ $optionKey }}" class="text-primary-600 focus:ring-primary-500">
                                                    <span class="ml-2 text-sm text-gray-700">{{ $optionLabel }}</span>
                                                </label>
                                            @endforeach
                                        </div>

                                    @elseif($variable['type'] === 'select')
                                        <select name="filters[{{ $key }}]" 
                                                class="form-select w-full rounded-md border-gray-300 shadow-sm focus:border-primary-300 focus:ring focus:ring-primary-200 focus:ring-opacity-50 text-sm">
                                            <option value="">Semua</option>
                                            @foreach($variable['options'] as $optionKey => $optionLabel)
                                                <option value="{{ $optionKey }}">{{ $optionLabel }}</option>
                                            @endforeach
                                        </select>

                                    @elseif($variable['type'] === 'boolean')
                                        <div class="space-y-2">
                                            <label class="inline-flex items-center">
                                                <input type="radio" name="filters[{{ $key }}]" 
                                                       value="" class="text-primary-600 focus:ring-primary-500" checked>
                                                <span class="ml-2 text-sm text-gray-700">Semua</span>
                                            </label>
                                            @foreach($variable['options'] as $optionKey => $optionLabel)
                                                <label class="inline-flex items-center">
                                                    <input type="radio" name="filters[{{ $key }}]" 
                                                           value="{{ $optionKey }}" class="text-primary-600 focus:ring-primary-500">
                                                    <span class="ml-2 text-sm text-gray-700">{{ $optionLabel }}</span>
                                                </label>
                                            @endforeach
                                        </div>

                                    @elseif($variable['type'] === 'age_filter')
                                        <div class="space-y-3">
                                            <select id="age_filter_select_{{ $key }}" 
                                                    class="form-select w-full rounded-md border-gray-300 shadow-sm focus:border-primary-300 focus:ring focus:ring-primary-200 focus:ring-opacity-50 text-sm">
                                                <option value="">Semua</option>
                                                @foreach($variable['options'] as $optionKey => $optionLabel)
                                                    <option value="{{ $optionKey }}">{{ $optionLabel }}</option>
                                                @endforeach
                                            </select>
                                            
                                            <div id="custom_age_range_{{ $key }}" class="hidden mt-2">
                                                <div class="grid grid-cols-2 gap-2">
                                                    <div>
                                                        <label class="block text-xs font-medium text-gray-700 mb-1">Usia minimum</label>
                                                        <input type="number" id="age_min_{{ $key }}" min="0" max="120" 
                                                               class="form-input w-full rounded-md border-gray-300 shadow-sm focus:border-primary-300 focus:ring focus:ring-primary-200 focus:ring-opacity-50 text-sm"
                                                               placeholder="Min">
                                                    </div>
                                                    <div>
                                                        <label class="block text-xs font-medium text-gray-700 mb-1">Usia maksimum</label>
                                                        <input type="number" id="age_max_{{ $key }}" min="0" max="120"
                                                               class="form-input w-full rounded-md border-gray-300 shadow-sm focus:border-primary-300 focus:ring focus:ring-primary-200 focus:ring-opacity-50 text-sm"
                                                               placeholder="Max">
                                                    </div>
                                                </div>
                                                <div class="mt-2">
                                                    <button type="button" id="apply_custom_age_{{ $key }}" 
                                                            class="w-full px-2 py-1 text-xs bg-primary-600 text-white rounded-md hover:bg-primary-700 focus:outline-none focus:ring-2 focus:ring-primary-500 focus:ring-offset-1">
                                                        Terapkan Rentang Usia
                                                    </button>
                                                </div>
                                            </div>
                                            
                                            <input type="hidden" name="filters[{{ $key }}]" id="age_filter_value_{{ $key }}">
                                        </div>

                                    @elseif($variable['type'] === 'number')
                                        <div class="space-y-2">
                                            <label class="inline-flex items-center">
                                                <input type="radio" name="filters[{{ $key }}]" 
                                                       value="" class="text-primary-600 focus:ring-primary-500" checked>
                                                <span class="ml-2 text-sm text-gray-700">Semua</span>
                                            </label>
                                            @foreach($variable['options'] as $optionKey => $optionLabel)
                                                <label class="inline-flex items-center">
                                                    <input type="radio" name="filters[{{ $key }}]" 
                                                           value="{{ $optionKey }}" class="text-primary-600 focus:ring-primary-500">
                                                    <span class="ml-2 text-sm text-gray-700">{{ $optionLabel }}</span>
                                                </label>
                                            @endforeach
                                        </div>

                                    @elseif($variable['type'] === 'string')
                                        <div class="space-y-2">
                                            <label class="inline-flex items-center">
                                                <input type="radio" name="filters[{{ $key }}]" 
                                                       value="" class="text-primary-600 focus:ring-primary-500" checked>
                                                <span class="ml-2 text-sm text-gray-700">Semua</span>
                                            </label>
                                            @foreach($variable['options'] as $optionKey => $optionLabel)
                                                <label class="inline-flex items-center">
                                                    <input type="radio" name="filters[{{ $key }}]" 
                                                           value="{{ $optionKey }}" class="text-primary-600 focus:ring-primary-500">
                                                    <span class="ml-2 text-sm text-gray-700">{{ $optionLabel }}</span>
                                                </label>
                                            @endforeach
                                        </div>

                                    @elseif($variable['type'] === 'date')
                                        <div class="space-y-2">
                                            <label class="inline-flex items-center">
                                                <input type="radio" name="filters[{{ $key }}]" 
                                                       value="" class="text-primary-600 focus:ring-primary-500" checked>
                                                <span class="ml-2 text-sm text-gray-700">Semua</span>
                                            </label>
                                            @foreach($variable['options'] as $optionKey => $optionLabel)
                                                <label class="inline-flex items-center">
                                                    <input type="radio" name="filters[{{ $key }}]" 
                                                           value="{{ $optionKey }}" class="text-primary-600 focus:ring-primary-500">
                                                    <span class="ml-2 text-sm text-gray-700">{{ $optionLabel }}</span>
                                                </label>
                                            @endforeach
                                        </div>

                                    @elseif($variable['type'] === 'datetime')
                                        <div class="space-y-2">
                                            <label class="inline-flex items-center">
                                                <input type="radio" name="filters[{{ $key }}]" 
                                                       value="" class="text-primary-600 focus:ring-primary-500" checked>
                                                <span class="ml-2 text-sm text-gray-700">Semua</span>
                                            </label>
                                            @foreach($variable['options'] as $optionKey => $optionLabel)
                                                <label class="inline-flex items-center">
                                                    <input type="radio" name="filters[{{ $key }}]" 
                                                           value="{{ $optionKey }}" class="text-primary-600 focus:ring-primary-500">
                                                    <span class="ml-2 text-sm text-gray-700">{{ $optionLabel }}</span>
                                                </label>
                                            @endforeach
                                        </div>

                                    @elseif($variable['type'] === 'time')
                                        <div class="space-y-2">
                                            <label class="inline-flex items-center">
                                                <input type="radio" name="filters[{{ $key }}]" 
                                                       value="" class="text-primary-600 focus:ring-primary-500" checked>
                                                <span class="ml-2 text-sm text-gray-700">Semua</span>
                                            </label>
                                            @foreach($variable['options'] as $optionKey => $optionLabel)
                                                <label class="inline-flex items-center">
                                                    <input type="radio" name="filters[{{ $key }}]" 
                                                           value="{{ $optionKey }}" class="text-primary-600 focus:ring-primary-500">
                                                    <span class="ml-2 text-sm text-gray-700">{{ $optionLabel }}</span>
                                                </label>
                                            @endforeach
                                        </div>

                                    @elseif($variable['type'] === 'textarea')
                                        <div class="space-y-2">
                                            <label class="inline-flex items-center">
                                                <input type="radio" name="filters[{{ $key }}]" 
                                                       value="" class="text-primary-600 focus:ring-primary-500" checked>
                                                <span class="ml-2 text-sm text-gray-700">Semua</span>
                                            </label>
                                            @foreach($variable['options'] as $optionKey => $optionLabel)
                                                <label class="inline-flex items-center">
                                                    <input type="radio" name="filters[{{ $key }}]" 
                                                           value="{{ $optionKey }}" class="text-primary-600 focus:ring-primary-500">
                                                    <span class="ml-2 text-sm text-gray-700">{{ $optionLabel }}</span>
                                                </label>
                                            @endforeach
                                        </div>

                                    @elseif($variable['type'] === 'file')
                                        <div class="space-y-2">
                                            <label class="inline-flex items-center">
                                                <input type="radio" name="filters[{{ $key }}]" 
                                                       value="" class="text-primary-600 focus:ring-primary-500" checked>
                                                <span class="ml-2 text-sm text-gray-700">Semua</span>
                                            </label>
                                            @foreach($variable['options'] as $optionKey => $optionLabel)
                                                <label class="inline-flex items-center">
                                                    <input type="radio" name="filters[{{ $key }}]" 
                                                           value="{{ $optionKey }}" class="text-primary-600 focus:ring-primary-500">
                                                    <span class="ml-2 text-sm text-gray-700">{{ $optionLabel }}</span>
                                                </label>
                                            @endforeach
                                        </div>

                                    @elseif($variable['type'] === 'image')
                                        <div class="space-y-2">
                                            <label class="inline-flex items-center">
                                                <input type="radio" name="filters[{{ $key }}]" 
                                                       value="" class="text-primary-600 focus:ring-primary-500" checked>
                                                <span class="ml-2 text-sm text-gray-700">Semua</span>
                                            </label>
                                            @foreach($variable['options'] as $optionKey => $optionLabel)
                                                <label class="inline-flex items-center">
                                                    <input type="radio" name="filters[{{ $key }}]" 
                                                           value="{{ $optionKey }}" class="text-primary-600 focus:ring-primary-500">
                                                    <span class="ml-2 text-sm text-gray-700">{{ $optionLabel }}</span>
                                                </label>
                                            @endforeach
                                        </div>

                                    @elseif($variable['type'] === 'video')
                                        <div class="space-y-2">
                                            <label class="inline-flex items-center">
                                                <input type="radio" name="filters[{{ $key }}]" 
                                                       value="" class="text-primary-600 focus:ring-primary-500" checked>
                                                <span class="ml-2 text-sm text-gray-700">Semua</span>
                                            </label>
                                            @foreach($variable['options'] as $optionKey => $optionLabel)
                                                <label class="inline-flex items-center">
                                                    <input type="radio" name="filters[{{ $key }}]" 
                                                           value="{{ $optionKey }}" class="text-primary-600 focus:ring-primary-500">
                                                    <span class="ml-2 text-sm text-gray-700">{{ $optionLabel }}</span>
                                                </label>
                                            @endforeach
                                        </div>

                                    @elseif($variable['type'] === 'audio')
                                        <div class="space-y-2">
                                            <label class="inline-flex items-center">
                                                <input type="radio" name="filters[{{ $key }}]" 
                                                       value="" class="text-primary-600 focus:ring-primary-500" checked>
                                                <span class="ml-2 text-sm text-gray-700">Semua</span>
                                            </label>
                                            @foreach($variable['options'] as $optionKey => $optionLabel)
                                                <label class="inline-flex items-center">
                                                    <input type="radio" name="filters[{{ $key }}]" 
                                                           value="{{ $optionKey }}" class="text-primary-600 focus:ring-primary-500">
                                                    <span class="ml-2 text-sm text-gray-700">{{ $optionLabel }}</span>
                                                </label>
                                            @endforeach
                                        </div>

                                    @elseif($variable['type'] === 'link')
                                        <div class="space-y-2">
                                            <label class="inline-flex items-center">
                                                <input type="radio" name="filters[{{ $key }}]" 
                                                       value="" class="text-primary-600 focus:ring-primary-500" checked>
                                                <span class="ml-2 text-sm text-gray-700">Semua</span>
                                            </label>
                                            @foreach($variable['options'] as $optionKey => $optionLabel)
                                                <label class="inline-flex items-center">
                                                    <input type="radio" name="filters[{{ $key }}]" 
                                                           value="{{ $optionKey }}" class="text-primary-600 focus:ring-primary-500">
                                                    <span class="ml-2 text-sm text-gray-700">{{ $optionLabel }}</span>
                                                </label>
                                            @endforeach
                                        </div>

                                    @elseif($variable['type'] === 'email')
                                        <div class="space-y-2">
                                            <label class="inline-flex items-center">
                                                <input type="radio" name="filters[{{ $key }}]" 
                                                       value="" class="text-primary-600 focus:ring-primary-500" checked>
                                                <span class="ml-2 text-sm text-gray-700">Semua</span>
                                            </label>
                                            @foreach($variable['options'] as $optionKey => $optionLabel)
                                                <label class="inline-flex items-center">
                                                    <input type="radio" name="filters[{{ $key }}]" 
                                                           value="{{ $optionKey }}" class="text-primary-600 focus:ring-primary-500">
                                                    <span class="ml-2 text-sm text-gray-700">{{ $optionLabel }}</span>
                                                </label>
                                            @endforeach
                                        </div>

                                    @elseif($variable['type'] === 'url')
                                        <div class="space-y-2">
                                            <label class="inline-flex items-center">
                                                <input type="radio" name="filters[{{ $key }}]" 
                                                       value="" class="text-primary-600 focus:ring-primary-500" checked>
                                                <span class="ml-2 text-sm text-gray-700">Semua</span>
                                            </label>
                                            @foreach($variable['options'] as $optionKey => $optionLabel)
                                                <label class="inline-flex items-center">
                                                    <input type="radio" name="filters[{{ $key }}]" 
                                                           value="{{ $optionKey }}" class="text-primary-600 focus:ring-primary-500">
                                                    <span class="ml-2 text-sm text-gray-700">{{ $optionLabel }}</span>
                                                </label>
                                            @endforeach
                                        </div>

                                    @elseif($variable['type'] === 'tel')
                                        <div class="space-y-2">
                                            <label class="inline-flex items-center">
                                                <input type="radio" name="filters[{{ $key }}]" 
                                                       value="" class="text-primary-600 focus:ring-primary-500" checked>
                                                <span class="ml-2 text-sm text-gray-700">Semua</span>
                                            </label>
                                            @foreach($variable['options'] as $optionKey => $optionLabel)
                                                <label class="inline-flex items-center">
                                                    <input type="radio" name="filters[{{ $key }}]" 
                                                           value="{{ $optionKey }}" class="text-primary-600 focus:ring-primary-500">
                                                    <span class="ml-2 text-sm text-gray-700">{{ $optionLabel }}</span>
                                                </label>
                                            @endforeach
                                        </div>

                                    @elseif($variable['type'] === 'password')
                                        <div class="space-y-2">
                                            <label class="inline-flex items-center">
                                                <input type="radio" name="filters[{{ $key }}]" 
                                                       value="" class="text-primary-600 focus:ring-primary-500" checked>
                                                <span class="ml-2 text-sm text-gray-700">Semua</span>
                                            </label>
                                            @foreach($variable['options'] as $optionKey => $optionLabel)
                                                <label class="inline-flex items-center">
                                                    <input type="radio" name="filters[{{ $key }}]" 
                                                           value="{{ $optionKey }}" class="text-primary-600 focus:ring-primary-500">
                                                    <span class="ml-2 text-sm text-gray-700">{{ $optionLabel }}</span>
                                                </label>
                                            @endforeach
                                        </div>

                                    @elseif($variable['type'] === 'checkbox')
                                        <div class="space-y-2">
                                            <label class="inline-flex items-center">
                                                <input type="checkbox" name="filters[{{ $key }}]" 
                                                       value="" class="text-primary-600 focus:ring-primary-500">
                                                <span class="ml-2 text-sm text-gray-700">Semua</span>
                                            </label>
                                            @foreach($variable['options'] as $optionKey => $optionLabel)
                                                <label class="inline-flex items-center">
                                                    <input type="checkbox" name="filters[{{ $key }}]" 
                                                           value="{{ $optionKey }}" class="text-primary-600 focus:ring-primary-500">
                                                    <span class="ml-2 text-sm text-gray-700">{{ $optionLabel }}</span>
                                                </label>
                                            @endforeach
                                        </div>

                                    @elseif($variable['type'] === 'radio')
                                        <div class="space-y-2">
                                            <label class="inline-flex items-center">
                                                <input type="radio" name="filters[{{ $key }}]" 
                                                       value="" class="text-primary-600 focus:ring-primary-500" checked>
                                                <span class="ml-2 text-sm text-gray-700">Semua</span>
                                            </label>
                                            @foreach($variable['options'] as $optionKey => $optionLabel)
                                                <label class="inline-flex items-center">
                                                    <input type="radio" name="filters[{{ $key }}]" 
                                                           value="{{ $optionKey }}" class="text-primary-600 focus:ring-primary-500">
                                                    <span class="ml-2 text-sm text-gray-700">{{ $optionLabel }}</span>
                                                </label>
                                            @endforeach
                                        </div>

                                    @elseif($variable['type'] === 'select')
                                        <select name="filters[{{ $key }}]" 
                                                class="form-select w-full rounded-md border-gray-300 shadow-sm focus:border-primary-300 focus:ring focus:ring-primary-200 focus:ring-opacity-50 text-sm">
                                            <option value="">Semua</option>
                                            @foreach($variable['options'] as $optionKey => $optionLabel)
                                                <option value="{{ $optionKey }}">{{ $optionLabel }}</option>
                                            @endforeach
                                        </select>

                                    @elseif($variable['type'] === 'boolean')
                                        <div class="space-y-2">
                                            <label class="inline-flex items-center">
                                                <input type="radio" name="filters[{{ $key }}]" 
                                                       value="" class="text-primary-600 focus:ring-primary-500" checked>
                                                <span class="ml-2 text-sm text-gray-700">Semua</span>
                                            </label>
                                            @foreach($variable['options'] as $optionKey => $optionLabel)
                                                <label class="inline-flex items-center">
                                                    <input type="radio" name="filters[{{ $key }}]" 
                                                           value="{{ $optionKey }}" class="text-primary-600 focus:ring-primary-500">
                                                    <span class="ml-2 text-sm text-gray-700">{{ $optionLabel }}</span>
                                                </label>
                                            @endforeach
                                        </div>

                                    @elseif($variable['type'] === 'age_filter')
                                        <div class="space-y-3">
                                            <select id="age_filter_select_{{ $key }}" 
                                                    class="form-select w-full rounded-md border-gray-300 shadow-sm focus:border-primary-300 focus:ring focus:ring-primary-200 focus:ring-opacity-50 text-sm">
                                                <option value="">Semua</option>
                                                @foreach($variable['options'] as $optionKey => $optionLabel)
                                                    <option value="{{ $optionKey }}">{{ $optionLabel }}</option>
                                                @endforeach
                                            </select>
                                            
                                            <div id="custom_age_range_{{ $key }}" class="hidden mt-2">
                                                <div class="grid grid-cols-2 gap-2">
                                                    <div>
                                                        <label class="block text-xs font-medium text-gray-700 mb-1">Usia minimum</label>
                                                        <input type="number" id="age_min_{{ $key }}" min="0" max="120" 
                                                               class="form-input w-full rounded-md border-gray-300 shadow-sm focus:border-primary-300 focus:ring focus:ring-primary-200 focus:ring-opacity-50 text-sm"
                                                               placeholder="Min">
                                                    </div>
                                                    <div>
                                                        <label class="block text-xs font-medium text-gray-700 mb-1">Usia maksimum</label>
                                                        <input type="number" id="age_max_{{ $key }}" min="0" max="120"
                                                               class="form-input w-full rounded-md border-gray-300 shadow-sm focus:border-primary-300 focus:ring focus:ring-primary-200 focus:ring-opacity-50 text-sm"
                                                               placeholder="Max">
                                                    </div>
                                                </div>
                                                <div class="mt-2">
                                                    <button type="button" id="apply_custom_age_{{ $key }}" 
                                                            class="w-full px-2 py-1 text-xs bg-primary-600 text-white rounded-md hover:bg-primary-700 focus:outline-none focus:ring-2 focus:ring-primary-500 focus:ring-offset-1">
                                                        Terapkan Rentang Usia
                                                    </button>
                                                </div>
                                            </div>
                                            
                                            <input type="hidden" name="filters[{{ $key }}]" id="age_filter_value_{{ $key }}">
                                        </div>

                                    @elseif($variable['type'] === 'number')
                                        <div class="space-y-2">
                                            <label class="inline-flex items-center">
                                                <input type="radio" name="filters[{{ $key }}]" 
                                                       value="" class="text-primary-600 focus:ring-primary-500" checked>
                                                <span class="ml-2 text-sm text-gray-700">Semua</span>
                                            </label>
                                            @foreach($variable['options'] as $optionKey => $optionLabel)
                                                <label class="inline-flex items-center">
                                                    <input type="radio" name="filters[{{ $key }}]" 
                                                           value="{{ $optionKey }}" class="text-primary-600 focus:ring-primary-500">
                                                    <span class="ml-2 text-sm text-gray-700">{{ $optionLabel }}</span>
                                                </label>
                                            @endforeach
                                        </div>

                                    @elseif($variable['type'] === 'string')
                                        <div class="space-y-2">
                                            <label class="inline-flex items-center">
                                                <input type="radio" name="filters[{{ $key }}]" 
                                                       value="" class="text-primary-600 focus:ring-primary-500" checked>
                                                <span class="ml-2 text-sm text-gray-700">Semua</span>
                                            </label>
                                            @foreach($variable['options'] as $optionKey => $optionLabel)
                                                <label class="inline-flex items-center">
                                                    <input type="radio" name="filters[{{ $key }}]" 
                                                           value="{{ $optionKey }}" class="text-primary-600 focus:ring-primary-500">
                                                    <span class="ml-2 text-sm text-gray-700">{{ $optionLabel }}</span>
                                                </label>
                                            @endforeach
                                        </div>

                                    @elseif($variable['type'] === 'date')
                                        <div class="space-y-2">
                                            <label class="inline-flex items-center">
                                                <input type="radio" name="filters[{{ $key }}]" 
                                                       value="" class="text-primary-600 focus:ring-primary-500" checked>
                                                <span class="ml-2 text-sm text-gray-700">Semua</span>
                                            </label>
                                            @foreach($variable['options'] as $optionKey => $optionLabel)
                                                <label class="inline-flex items-center">
                                                    <input type="radio" name="filters[{{ $key }}]" 
                                                           value="{{ $optionKey }}" class="text-primary-600 focus:ring-primary-500">
                                                    <span class="ml-2 text-sm text-gray-700">{{ $optionLabel }}</span>
                                                </label>
                                            @endforeach
                                        </div>

                                    @elseif($variable['type'] === 'datetime')
                                        <div class="space-y-2">
                                            <label class="inline-flex items-center">
                                                <input type="radio" name="filters[{{ $key }}]" 
                                                       value="" class="text-primary-600 focus:ring-primary-500" checked>
                                                <span class="ml-2 text-sm text-gray-700">Semua</span>
                                            </label>
                                            @foreach($variable['options'] as $optionKey => $optionLabel)
                                                <label class="inline-flex items-center">
                                                    <input type="radio" name="filters[{{ $key }}]" 
                                                           value="{{ $optionKey }}" class="text-primary-600 focus:ring-primary-500">
                                                    <span class="ml-2 text-sm text-gray-700">{{ $optionLabel }}</span>
                                                </label>
                                            @endforeach
                                        </div>

                                    @elseif($variable['type'] === 'time')
                                        <div class="space-y-2">
                                            <label class="inline-flex items-center">
                                                <input type="radio" name="filters[{{ $key }}]" 
                                                       value="" class="text-primary-600 focus:ring-primary-500" checked>
                            <div class="bg-gray-50 p-4 rounded-b-xl text-center">
                                <button id="closeHelpOkBtn" class="px-4 py-2 bg-primary-600 text-white text-sm font-medium rounded-md shadow-sm hover:bg-primary-700 focus:outline-none focus:ring-2 focus:ring-primary-500 flex items-center mx-auto">
                                    <i class="fas fa-check mr-2"></i>
                                    Mengerti
                                                    </button>
                                                </div>
                                            </div>
                                        </div>
                `;
                
                // Tambahkan modal ke body
                $('body').append(helpModalHTML);
                
                // Handle close button
                $('#closeHelpBtn, #closeHelpOkBtn').click(function() {
                    $('#helpModal').removeClass('modal-enter').addClass('modal-exit');
                    setTimeout(function() {
                        $('#helpModal').remove();
                    }, 300);
                });
                
                // Close dengan ESC
                $(document).on('keydown', function(e) {
                    if (e.key === 'Escape' && $('#helpModal').length) {
                        $('#closeHelpBtn').click();
                    }
                });
            });
            
            // FILTER USIA KUSTOM
            // Toggle tampilan input kustom
            $('select[id^="age_filter_select_"]').change(function() {
                const id = $(this).attr('id').replace('age_filter_select_', '');
                if ($(this).val() === 'custom') {
                    $(`#custom_age_range_${id}`).removeClass('hidden');
                } else {
                    $(`#custom_age_range_${id}`).addClass('hidden');
                    // Set nilai filter berdasarkan pilihan dropdown
                    $(`#age_filter_value_${id}`).val($(this).val());
                }
            });
            
            // Terapkan rentang usia kustom
            $('button[id^="apply_custom_age_"]').click(function() {
                const id = $(this).attr('id').replace('apply_custom_age_', '');
                const minAge = $(`#age_min_${id}`).val();
                const maxAge = $(`#age_max_${id}`).val();
                
                if (minAge && maxAge) {
                    // Format rentang usia: min-max
                    $(`#age_filter_value_${id}`).val(minAge + '-' + maxAge);
                    showToast('Rentang usia ' + minAge + '-' + maxAge + ' tahun diterapkan', 'success');
                } else if (minAge) {
                    // Format usia minimum: min+
                    $(`#age_filter_value_${id}`).val(minAge + '+');
                    showToast('Usia minimum ' + minAge + '+ tahun diterapkan', 'success');
                } else if (maxAge) {
                    // Format usia maksimum: 0-max
                    $(`#age_filter_value_${id}`).val('0-' + maxAge);
                    showToast('Usia maksimum 0-' + maxAge + ' tahun diterapkan', 'success');
                } else {
                    showToast('Harap masukkan rentang usia', 'error');
                }
            });
        });
    </script>
</body>
</html>